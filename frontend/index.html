<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Atividade Extraclasse PSPD 1</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      html, body, #root {
        height: 100%;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div id="root">Loading...</div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <script>
      const e = React.createElement;

      function App() {
        const [input, setInput] = React.useState("");
        const [message, setMessage] = React.useState("");

        const handleSubmit = (e) => {
          e.preventDefault();
          fetch("/api/invert/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ text: input })
          })
            .then(r => r.json())
            .then(data => setMessage(data.message))
            .catch(err => setMessage("Error: " + err.message));
        };

        return e("div", 
          { style:
            { paddingTop: "2rem", 
            textAlign: "center",
            width: '100%', 
            height: '100%',
            backgroundColor: '#005C53',
            color:'#0CF25D'
          } },
          e("h2", null, "Inverte Palavras (Servidor gRPC Node JS)"),
          e("form", { onSubmit: handleSubmit },
            e("input", {
              value: input,
              onChange: ev => setInput(ev.target.value),
              placeholder: "Digite uma palavra",
              style: { padding: "0.5rem", marginRight: "0.5rem" }
            }),
            e("button", { type: "submit" }, "Inverter")
          ),
          message && e("h2", null, "Resultado: " + message)
        );
      }

      const container = document.getElementById('root');
      ReactDOM.createRoot(container).render(e(App));
    </script>
  </body>
</html>
